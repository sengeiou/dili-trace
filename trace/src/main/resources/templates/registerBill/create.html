
<#bodyOrigin>
    <style>
        .form-inline .table-showlist table .input-sm {
             width: 200px;
        }
    </style>
<div class="main-container">
    <div class="topicTop">
        <div class="toppic-title">
            <span class="topic-title-text maincolor">进场货品登记</span>
            <button class="btn-greyweak btn-sm topic-back-btn" onclick="parent.closeWin('view_win')">返回</button>
        </div>
    </div>
    <div class="form-box border">

        <form id="createRecordForm" class="form-inline" role="form">
            <div class="form-item-group">
                <h4 class="form-item-title">基础信息</h4>
                <div class="form-group">
                    <label class="label-title text-right"><span class="red">&lowast;</span>登记来源</label>
                    <select class="form-control input-sm" name="registerSource" id="registerSource" required tabindex="0">
                        <option value="1">理货区</option>
                        <option value="2">交易区</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="label-title text-right"><span class="red">&lowast;</span>理货区号</label>
                    <div class="input-group">
                        <input type="hidden" name="tallyAreaNo" id="tallyAreaNo"/>
                        <input type="text" class="form-control input-sm isInt" name="tallyAreaNoInput" id="tallyAreaNoInput" maxlength="6" onkeyup="onKeyUpEnter3(event)" style="width: 147px;"/>
                        <span class="input-group-addon"> <span class="glyphicon" onclick="tallyAreaNo()">检索</span> </span>
                    </div>
                </div>

                <div class="form-group" style="display: none;">
                    <label class="label-title text-right">
                        <span class="red">&lowast;</span>交易区号</label>
                    <select class="form-control input-sm" name="tradeTypeId" id="tradeTypeId"  required>
                        <option value="">请选择</option>
                        <% if( isNotEmpty(tradeTypes) && tradeTypes.~size>0)
                            for(tradeType in tradeTypes){%>
                        <option value="${tradeType.typeId}">${tradeType.typeName}</option>
                        <%}%>
                    </select>
                </div>
                <div class="form-group">
                    <label class="label-title text-right">
                        <span class="red">&lowast;</span>车牌号</label>
                    <input type="text" class="form-control input-sm isWord isPlate" name="plate" id="plate" maxlength="8" minlength="7" required />
                </div>
                <div class="form-group" style="display: none;">
                    <label class="label-title text-right">交易账号</label>
                    <div class="input-group">
                        <input type="text" class="form-control input-sm" name="tradeAccountInput" id="tradeAccountInput" onkeyup="onKeyUpEnter(event)" style="width: 147px;"/>
                        <input type="hidden" name="tradeAccount" id="tradeAccount"/>
                        <span class="input-group-addon"> <span class="glyphicon" onclick="customerId()">检索</span> </span>
                    </div>
                </div>
                <div class="form-group" style="display: none;">
                    <label class="label-title text-right">印刷卡号</label>
                    <div class="input-group">
                        <input type="text" class="form-control input-sm" name="b2" id="printingCardInput" onkeyup="onKeyUpEnter2(event)" style="width: 147px;"/>
                        <input type="hidden"  name="tradePrintingCard" id="tradePrintingCard" onkeyup="onKeyUpEnter2(event)" style="width: 147px;"/>
                        <span class="input-group-addon"> <span class="glyphicon" onclick="cardNo()">检索</span> </span>
                    </div>
                </div>
                <br>
                <div class="form-group">
                    <label class="label-title text-right">
                        <span class="red">&lowast;</span>业户姓名</label>
                    <input type="text" class="form-control input-sm" name="name" id="name" tabindex="-1" required readonly/>
                    <input type="hidden"  name="userId" id="userId" required readonly/>
                </div>
                <div class="form-group">
                    <label class="label-title text-right">
                        <span class="red">&lowast;</span>身份证号</label>
                    <input name="idCardNo" id="idCardNo" type="text" class="form-control input-sm" tabindex="-1" required readonly/>
                </div>
                <div class="form-group">
                    <label class="label-title text-right"><span class="red">&lowast;</span>身份证地址</label>
                    <textarea name="addr" id="addr" class="form-control"  rows="1" maxlength="50" tabindex="-1" readonly style="width: 200px;"></textarea>
                </div>
                <div class="form-group">
                    <label class="label-title text-right">
                        <span class="red">&lowast;</span>业户手机号</label>
                    <input name="phone" id="phone" type="text" class="form-control input-sm" tabindex="-1" readonly/>
                </div>
            </div>

            <div class="form-item-group">
                <h4 class="form-item-title">货品信息</h4>
                <button type="button" class="btn-main2 btn-sm" id="addGoodsItem" style="width: 85px;">添加货品</button>
                <div class="table-showlist" style="width: 1200px">
                    <table class="table table-bordered" id="goodsTable">
                        <thead>
                        <tr>
                            <th><span class="red">&lowast;</span>商品名称</th>
                            <th><span class="red">&lowast;</span>产地</th>
                            <th><span class="red">&lowast;</span>商品重量/KG</th>
                            <th>产地证明</th>
                            <th>操作</th>
                        </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                    <!-- 表格后的统计 end -->
                </div>
            </div>
            <div class="form-group">
                <div class="table-showlist" style="width: 1200px">
                 常用产地: <% for(city in citys){%>
                        <a href="javascript:void(0)" onclick="selectCity(this,${city.id},'${city.mergerName}')" title="${city.mergerName}">${city.name}</a>
                    <%}%>
                </div>
            </div>
            <div class="form-item-group">
                <h4 class="form-item-title">检测报告</h4>
                <div class="fileimg-box" style="margin-left: 50px;">
                    <span class="fileimg-plus-icon">+</span>
                    <span class="fileimg-des">点击上传</span>
                    <input id="detectReportUrlFile" type="file" name="file" data-url="${contextPath!}/action/imageApi/upload" multiple="multipart/form-data"/>
                    <input type="hidden" name="detectReportUrl" id="detectReportUrl">
                    <img class="magnifying">
                    <div class="fileimg-cover" style="display: none;"></div>
                    <div class="fileimg-edit" style="display: none;">
                        <span class="fileimg-view">查看</span>
                    </div>
                </div>
            </div>
        </form>

    </div>
    <!--<h5 class="mt10 red">操作员：陈良芳</h5>-->
    <div class="text-center mt30">
        <button class="btn-main2 btn-sm" onclick="create()">提交</button>&nbsp;&nbsp;
        <button class="btn-greyweak btn-sm" onclick="parent.closeWin('view_win')">取消</button>
    </div>
</div>
</#bodyOrigin>
<#registerBill_createJs />
<link rel="stylesheet" type="text/css" href="${contextPath!}/resources/jquery-file-upload/css/jquery.fileupload.css">
<script src="${contextPath!}/resources/jquery-file-upload/js/vendor/jquery.ui.widget.js"></script>
<script src="${contextPath!}/resources/jquery-file-upload/js/jquery.iframe-transport.js"></script>
<script src="${contextPath!}/resources/jquery-file-upload/js/jquery.fileupload.js"></script>
<!--<script src="/resources/assets/dep/jquery/layer/layer.js"></script>-->
<style>
    /*a  upload */
    .a-upload {
        padding: 4px 28px;
        position: relative;
        cursor: pointer;
        border: 1px solid #ddd;
        border-radius: 4px;
        overflow: hidden;
        display: inline-block;
        color: #fff !important;
        background-color: #3370ff;
    }

    .a-upload  input {
        position: absolute;
        font-size: 100px;
        right: 0;
        top: 0;
        opacity: 0;
        filter: alpha(opacity=0);
        cursor: pointer
    }

    .a-upload:hover {
        color: #444;
        background: #eee;
        border-color: #ccc;
        text-decoration: none
    }
</style>
<script id="goodsItem" type="text/html">
    <tr>
        <td>
            <div class="form-group">
                <input type="text" class="form-control input-sm isSelected" name="productName_{{index}}" id="productName_{{index}}" required />
                <input type="text" name="productId_{{index}}" hidden value=""/>
            </div>
        </td>
        <td>
            <div class="form-group">
                <input type="text"   name="originName_{{index}}" class="form-control input-sm isSelected originaNameInput" id="originName_{{index}}" required />
                <input type="text" name="originId_{{index}}" hidden value="" />
            </div>
        </td>
        <td>
            <div class="form-group">
                <input type="text" class="form-control input-sm isInt" name="weight_{{index}}" maxlength="6"  range="0 999999" value="0" />
            </div>
        </td>
        <td>
            <div class="upload-div">
                <a href="javascript:;" class="a-upload" tabindex="-1">
                    <input type="file" id="originCertifiyUrl_{{index}}"type="file" name="file" data-url="${contextPath!}/action/imageApi/upload" multiple="multipart/form-data">
                    <span>上传</span>
                    <input type="hidden" name="originCertifiyUrl_{{index}}">
                </a>
            </div>
            <div class="view-div" style="display: none;">
                <span>已上传</span>
                <a href="javascript:;" data-index="{{index}}" class="img-view-a">查看图片</a>
                <a href="javascript:$('#originCertifiyUrl_{{index}}').trigger('click')">重新上传</a>
            </div>
        </td>
        <td><a href="javascript:;" class="split-minus-btn">删除</a></td>
    </tr>

</script>

