<#bs4Body>

<div class="container-fluid">
    <form id="queryForm" role="form" >
        <div class="row row-cols-6">
            <div class="form-group col-auto">
                <label for="modifiedStart">查询时间</label>
                <div class="form-inline">
                    <div class="input-group">
                        <input type="text" name="modifiedStart" id="modifiedStart" class="form-control laydatetime laystart" />
                        <div class="input-group-append">
                            <label for="modifiedStart" class="input-group-text fa fa-calendar"></label>
                        </div>
                    </div>&nbsp;&nbsp;至&nbsp;&nbsp;
                    <div class="input-group">
                        <input type="text" name="modifiedEnd" id="modifiedEnd" class="form-control laydatetime layend" />
                        <div class="input-group-append">
                            <label for="modifiedEnd" class="input-group-text fa fa-calendar"></label>
                        </div>
                    </div>
                </div>
            </div>

            <div class="form-group col-auto">
                <label for="createdStart">注册时间</label>
                <div class="form-inline">
                    <div class="input-group">
                        <input type="text" name="createdStart" id="createdStart" class="form-control laydatetime laystart" />
                        <div class="input-group-append">
                            <label for="createdStart" class="input-group-text fa fa-calendar"></label>
                        </div>
                    </div>&nbsp;&nbsp;至&nbsp;&nbsp;
                    <div class="input-group">
                        <input type="text" name="createdEnd" id="createdEnd" class="form-control laydatetime layend" />
                        <div class="input-group-append">
                            <label for="createdEnd" class="input-group-text fa fa-calendar"></label>
                        </div>
                    </div>
                </div>
            </div>

            <div class="form-group col">
                <label for="name">姓名</label>
                <input type="text" class="form-control" name="name" id="name"/>
            </div>


            <div class="form-group col">
                <label for="phone">手机号</label>
                <input type="text" class="form-control" name="phone" id="phone"/>
            </div>

            <div class="form-group col">
                <label for="likeTallyAreaNos">理货区号</label>
                <input type="text" class="form-control" name="likeTallyAreaNos" id="likeTallyAreaNos"/>
            </div>

            <div class="form-group col">
                <label for="salesCityId">销地城市</label>
                <!--data-options="label:'销地城市:',loader:cityLoader,mode: 'remote',valueField:'value' ,textField:'text',prompt:'请输入', panelWidth:'auto',panelMinWidth:'175', panelHeight:'auto',panelMaxHeight:'300',  editable:true,validType:'comboBoxEditvalid[\'salesCityId\']'">-->
                <select id="salesCityId" name="salesCityId" class="form-control"></select>
            </div>

            <div class="form-group col">
                <label for="likeUserPlates">车牌</label>
                <input type="text" class="form-control" name="likeUserPlates" id="likeUserPlates"/>
            </div>

            <div class="form-group col">
                <label for="hasBusinessLicense">营业执照</label>
                <select id="hasBusinessLicense" name="hasBusinessLicense" class="form-control">
                    <option value="">--请选择--</option>
                    <option value="true">有</option>
                    <option value="false">无</option>
                </select>
            </div>

            <div class="form-group col">
                <label for="state">状态</label>
                <select id="state" name="state" class="form-control"></select>
                <#bcomboProvider _id="state" _provider="enabledStateProvider" _value="" _onLoadSuccess=""/>
            </div>

            <div class="col-auto align-self-center mt-3">
                <button id="clear" type="button" class="btn btn-outline-primary mr-2" onclick="javascript:$('#queryForm .form-control').val('');"><i class="fa fa-refresh"></i> 清空</button>
                <button id="query" type="button" class="btn btn-outline-primary"><i class="fa fa-search"></i> 查询</button>
            </div>

            <div class="form-group col">
                <label for="plateAmount">车牌总数量</label>
                <input type="text" class="form-control statics" name="plateAmount" id="plateAmount" value="0" readonly="readonly" disabled="disabled"/>
            </div>

        </div>
    </form>
    <hr>
    <div>
        <table id="grid" data-toggle="table" data-title="业户信息统计列表" class="table" data-pagination="true" data-page-number="1" data-page-size="10"
               data-query-params="queryParams" data-side-pagination="server" data-method="POST" data-content-type="application/x-www-form-urlencoded" data-single-select="true"
               data-click-to-select="true"  data-checkbox-header="false" data-unique-id="id" data-sort-name="id" data-sort-order="desc"  data-icons="bui.variable.icons" data-buttons-class="primary"
               data-show-refresh="true" data-show-fullscreen="true" data-show-columns="true" data-detail-view="true">
            <thead>
            <tr>
                <th data-field="modified" data-sortable="true" data-align="center" data-provider="datetimeProvider">
                    变更时间
                </th>
                <th data-field="created" data-sortable="true" data-align="center" data-provider="datetimeProvider">
                    注册时间
                </th>
                <th data-field="name" data-sortable="true" data-align="center">
                    姓名
                </th>
                <th data-field="phone" data-sortable="true" data-align="center" data-formatter="phoneFormatter">
                    手机号
                </th>
                <th data-field="cardNo" data-align="center" data-formatter="cardNoFormatter">
                    身份证号
                </th>
                <th data-field="tallyAreaNos" data-align="center">
                    理货区号
                </th>
                <th data-field="salesCityName"data-align="center">
                    销地城市
                </th>
                <th data-field="userPlates" data-align="center">
                    车牌
                </th>
                <th data-field="businessLicenseUrl" data-align="center" data-formatter="function(val){return val?'有':'无'}">
                    营业执照
                </th>
                <th data-field="state" data-sortable="true" data-align="center" data-provider="enabledStateProvider">
                    状态
                </th>
                <th data-field="yn" data-sortable="true" data-align="center" data-provider="ynEnumStateProvider">
                    是否删除
                </th>
            </tr>
            </thead>
        </table>
    </div>
</div>

</#bs4Body>
<script src="${contextPath!}/resources/assets/dep/underscore/underscore-min.js"></script>
<script src="${contextPath!}/resources/js/jquery.serializejson.js"></script>
<script src="${contextPath!}/resources/js/Utils.js"></script>
<script src="${contextPath!}/resources/js/WebConfig.js"></script>
<script src="${contextPath!}/resources/js/userHistoryService.index.js"></script>
<#webGlobalConfig/>
<script>
    $(function () {
        var userHistoryServiceIndex=new UserHistoryServiceIndex($('#grid'),$('#queryForm'));
    });

    function phoneFormatter(val,row){
        if(val){
            return val.replace(val.substring(3,7), "****")
        }
        return val;
    }

    function cardNoFormatter(val,row){
        if(val){
            var val = val.substr(0,4)+'**************';
        }
        return val;
    }

    function selectCity(cthis,id,name){
        $('#_salesCityId').combobox('setValue',id);
        $('#_salesCityId').combobox('setText',name);
        $('#_salesCityName').val(name);
    }

    /**
     * 城市自动联想加载
     * ***/
    function cityLoader(param,success,error) {
        var q = param.q || '';
        if (q.length < 1){return false}
        $.ajax({
            type: "POST",
            url: '${contextPath}/provider/getLookupList.action',
            dataType: 'json',
            data: {
                provider: 'cityProvider',
                queryParams: '{required:true}',
                value: q
            },
            success: function(data){
                success(data);
            },
            error: function(){
                error.apply(this, arguments);
            }
        });
    }

    //表格表头右键菜单
    function headerContextMenu(e, field){
        e.preventDefault();
        if (!cmenu){
            createColumnMenu("userGrid");
        }
        cmenu.menu('show', {
            left:e.pageX,
            top:e.pageY
        });
    }

    /**
     * 绑定页面回车事件，以及初始化页面时的光标定位
     * @formId
     *          表单ID
     * @elementName
     *          光标定位在指点表单元素的name属性的值
     * @submitFun
     *          表单提交需执行的任务
     */
    // $(function () {
    //     window._userGrid = $('#userGrid');
    //     bindFormEvent("queryForm", "createdStart", queryUserGrid);
    //     //  initUserGrid();
    //     queryUserGrid();
    // })


</script>